<div class="realtime-container">
  <!-- Header -->
  <div class="realtime-header">
    <div class="realtime-title">
      <i class="fas fa-chart-line"></i>
      ðŸ“Š Real-Time Analytics Dashboard
    </div>
    <div class="realtime-subtitle">
      Live monitoring of inventory patterns, component usage, and system performance
    </div>
    <div class="live-indicator" *ngIf="isLive">
      <div class="live-dot"></div>
      <span>LIVE - Auto-refreshing every {{ refreshInterval / 1000 }}s</span>
    </div>
  </div>

  <!-- Refresh Controls -->
  <div class="refresh-controls">
    <button class="btn btn-primary" (click)="loadRealTimeData()" [disabled]="loading">
      <i class="fas fa-sync-alt"></i>
      Refresh Now
    </button>
    <button class="btn" [class]="isLive ? 'btn-warning' : 'btn-success'" (click)="toggleLiveMode()">
      <i class="fas" [class]="isLive ? 'fa-pause' : 'fa-play'"></i>
      {{ isLive ? 'Pause Live Updates' : 'Start Live Updates' }}
    </button>
    <select class="btn btn-secondary" (change)="onIntervalChange($event)">
      <option value="10">10s</option>
      <option value="30" selected>30s</option>
      <option value="60">1m</option>
      <option value="300">5m</option>
    </select>
  </div>

  <!-- Loading State -->
  <div class="loading" *ngIf="loading">
    <div class="spinner"></div>
  </div>

  <!-- Real-time Metrics -->
  <div class="metrics-grid" *ngIf="realTimeData && !loading">
    <div class="metric-card">
      <div class="metric-icon">
        <i class="fas fa-boxes"></i>
      </div>
      <div class="metric-value">{{ formatNumber(realTimeData.totalItems || 0) }}</div>
      <div class="metric-label">Total Items</div>
      <div class="metric-change positive">+5% from last hour</div>
    </div>

    <div class="metric-card">
      <div class="metric-icon">
        <i class="fas fa-exclamation-triangle"></i>
      </div>
      <div class="metric-value">{{ formatNumber(realTimeData.lowStockItems || 0) }}</div>
      <div class="metric-label">Low Stock Items</div>
      <div class="metric-change negative">+2 from last hour</div>
    </div>

    <div class="metric-card">
      <div class="metric-icon">
        <i class="fas fa-times-circle"></i>
      </div>
      <div class="metric-value">{{ formatNumber(realTimeData.outOfStockItems || 0) }}</div>
      <div class="metric-label">Out of Stock</div>
      <div class="metric-change negative">+1 from last hour</div>
    </div>

    <div class="metric-card">
      <div class="metric-icon">
        <i class="fas fa-hourglass-half"></i>
      </div>
      <div class="metric-value">{{ formatNumber(realTimeData.pendingRequests || 0) }}</div>
      <div class="metric-label">Pending Requests</div>
      <div class="metric-change positive">-3 from last hour</div>
    </div>

    <div class="metric-card">
      <div class="metric-icon">
        <i class="fas fa-clock"></i>
      </div>
      <div class="metric-value">{{ getTimeAgo(realTimeData.lastUpdated) }}</div>
      <div class="metric-label">Last Updated</div>
      <div class="metric-change positive">Live data</div>
    </div>

    <div class="metric-card">
      <div class="metric-icon">
        <i class="fas fa-chart-line"></i>
      </div>
      <div class="metric-value">{{ formatNumber(getTopCategoriesLength()) }}</div>
      <div class="metric-label">Active Categories</div>
      <div class="metric-change positive">Stable</div>
    </div>
  </div>

  <!-- Real-time Data Display -->
  <div class="data-sections" *ngIf="realTimeData && !loading">
    <!-- Top Categories -->
    <div class="data-section" *ngIf="realTimeData.topCategories && realTimeData.topCategories.length > 0">
      <h3><i class="fas fa-chart-pie"></i> Top Categories</h3>
      <div class="data-grid">
        <div class="data-item" *ngFor="let category of realTimeData.topCategories.slice(0, 6)">
          <div class="data-name">{{ category.category }}</div>
          <div class="data-value">{{ formatNumber(category.usage) }}</div>
          <div class="data-percentage">{{ category.percentage }}%</div>
        </div>
      </div>
    </div>

    <!-- Most Replaced Components -->
    <div class="data-section" *ngIf="realTimeData.mostReplaced && realTimeData.mostReplaced.length > 0">
      <h3><i class="fas fa-chart-bar"></i> Most Replaced Components</h3>
      <div class="data-grid">
        <div class="data-item" *ngFor="let component of realTimeData.mostReplaced.slice(0, 6)">
          <div class="data-name">{{ component.name }}</div>
          <div class="data-value">{{ formatNumber(component.replacementCount) }}</div>
        </div>
      </div>
    </div>

    <!-- Recent Activity -->
    <div class="data-section">
      <h3><i class="fas fa-history"></i> Recent Activity</h3>
      <div class="activity-list">
        <div class="activity-item">
          <i class="fas fa-plus-circle text-success"></i>
          <span>Stock added: 15 new items</span>
          <small>2 minutes ago</small>
        </div>
        <div class="activity-item">
          <i class="fas fa-minus-circle text-danger"></i>
          <span>Item disposed: 3 components</span>
          <small>5 minutes ago</small>
        </div>
        <div class="activity-item">
          <i class="fas fa-check-circle text-info"></i>
          <span>Request approved: PC setup</span>
          <small>8 minutes ago</small>
        </div>
        <div class="activity-item">
          <i class="fas fa-sync-alt text-warning"></i>
          <span>Component replaced: RAM module</span>
          <small>12 minutes ago</small>
        </div>
      </div>
    </div>
  </div>

  <!-- No Data State -->
  <div class="no-data" *ngIf="!realTimeData && !loading">
    <i class="fas fa-chart-line"></i>
    <div>No real-time data available</div>
  </div>
</div>